<div id="inventory-page" class="inventory-page-container">
  <%= link_to "Back to Profile", account_path, class: "back-button" %>

  <h1>Your Inventory</h1>

  <!-- Tabs Navigation -->
  <div class="tabs-navigation">
    <%= link_to "Avatars", inventory_index_path(tab: "avatars"), class: "tab-link #{params[:tab] == 'avatars' || params[:tab].nil? ? 'active' : ''}" %>
    <%= link_to "Consumables", inventory_index_path(tab: "consumables"), class: "tab-link #{params[:tab] == 'consumables' ? 'active' : ''}" %>
    <%= link_to "Weapons", inventory_index_path(tab: "weapons"), class: "tab-link #{params[:tab] == 'weapons' ? 'active' : ''}" %>
  </div>

  <!-- Avatars (Skins) Content -->
  <% if params[:tab] == 'avatars' || params[:tab].nil? %>
    <div class="skins-container">
      <% @skins.each do |skin| %>
        <div class="skin-item <%= 'current-skin' if skin.current %>" data-skin-id="<%= skin.id %>" data-skin="<%= skin.to_json %>" onclick="showSkinStats(<%= skin.id %>)">
          <p class="archetype-display">Archetype: <%= skin.archetype %></p>
          <% if skin.image.attached? %>
            <%= image_tag skin.image, class: "skin-image", alt: "Skin" %>
          <% else %>
            <p class="no-image-placeholder">No image available</p>
          <% end %>

          <div class="skin-info">
            <% if skin.current %>
              <span class="current-badge">Current Skin</span>
            <% else %>
              <%= button_to "Set as Current", set_current_inventory_path(skin), method: :patch, class: "set-current-button" %>
              <%= button_to "Remove", inventory_path(skin), method: :delete, data: { confirm: "Are you sure you want to remove this skin?" }, class: "remove-skin-button" %>
            <% end %>
          </div>
        </div>
      <% end %>
    </div>
  <% end %>

  <!-- Consumables Content -->
  <% if params[:tab] == 'consumables' %>
    <div class="consumables-container">
      <p>You currently have no consumables.</p>
    </div>
  <% end %>

  <!-- Weapons Content -->
  <% if params[:tab] == 'weapons' %>
    <div class="weapons-container">
      <% @weapons.each do |weapon| %>
        <div class="weapon-item">
          <p><strong><%= weapon.name %></strong></p>
          <%# Use the helper method to get the right image filename %>
          <%= image_tag asset_path(weapon_image_filename(weapon.name)), alt: weapon.name, class: "weapon-image" %>
        </div>
      <% end %>

      <% if @weapons.empty? %>
        <p>You have no weapons.</p>
      <% end %>
    </div>
  <% end %>

  <!-- Modal for Skin Stats -->
  <div id="skin-stats-modal" class="modal">
    <div class="modal-content">
      <span class="close-button" onclick="closeModal()">&times;</span>
      <h2>Skin Stats</h2>
      <div id="skin-stats">
        <!-- Stats will be dynamically populated here -->
      </div>
    </div>
  </div>
</div>
